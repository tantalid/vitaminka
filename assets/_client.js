flexbe_cli.block.register("ACADEMY_FEED",{lastItem:0,loading:!1,list:[],onScreen(t){t&&this.initFeed()},initFeed(){this.feedInited=!0,this.$loader=this.$area.find(".updates-loader");let t=-1,e=flexbe_cli.resize.viewportHeight,i=!1;const a=()=>{if(requestAnimationFrame(a),!this.tween||!this.inScreen||this.feedInited&&t===flexbe_cli.scroll.latest)return;t=flexbe_cli.scroll.latest,e=flexbe_cli.resize.viewportHeight,i=this.loaderState;const{top:s}=this.$loader.offset()||{};this.loaderState=t+e>=s-300,i!==this.loaderState&&this.loaderState&&this.loadFeed()};requestAnimationFrame(a)},loadFeed(t=(()=>{})){if(this.loading)return;this.loading=!0;const e=[];$.ajax({url:"/admin/updates/get_updates",type:"POST",dataType:"json",data:{limit:5,last_id:this.lastItem}}).done(i=>{if(!i.is_success||!i.data)return void t(new Error(i.message));let a="",s=-1;i.data.forEach(t=>{const i=this.list.findIndex(e=>e.id==t.id);if(i>=0)s=i,this.list.splice(i,1,t);else{const i=-1===s?this.list.length:s;this.list.splice(i,0,t),e.splice(i,0,t)}}),e.forEach(t=>{a+='<div class="card-item"><div class="date-wrap"><span data-info="data" class="date">',a+=t.date,a+='</span></div><div class="line-wrap"><span class="line line-top"></span><span class="dot"></span><span class="line line-bottom"></span></div><div class="card-wrapper"><div class="img-card">',a+=`<img  data-info="img"  src="${t.image_retina}">`,a+=`</div><div class="info"><span  data-info="data"  class="mobile-date">${t.date}</span>`,a+=`<div  data-info="title"  class="title">${t.title}</div>`,a+=`<div  data-info="text"  class="text">${t.text}</div>`,t.buttons.length&&(a+='<div class="wrap-button">',t.buttons.forEach(t=>{a+=`<a href="${t.url}"`,a+=t.new_window?' target="_blank"':"",a+=` class="gubert-button blue fill select size-l">${t.title}</a>`}),a+="</div>"),a+="</div></div></div>"}),this.list.length&&this.$area.find(".updates-loader-wrap").removeClass("zero"),e.length&&this.$area.find(".cards-container").append(a),e.length<5&&(this.$area.find(".updates-loader-wrap").removeClass("active"),this.$area.find(".card-item:last-of-type .line.line-bottom").css("width","0")),this.loading=!1,this.lastItem=this.list[this.list.length-1].id}).fail(e=>{t(new Error(e)),this.loading=!1})}});
flexbe_cli.block.register("BUNDLE",{selectedTab:location.hash.replace(/^#tab/,""),subscribedOnscroll:!1,iteracted:!1,onInit(){this.initTabs()},onLoad(){this.inScreen&&this.swipeAnimationController()},onUpdate(t){t.templateRendered&&this.initTabs()},onResize(){this.normalizeLines()},onBeside(t){t||this.resetHash()},onScreen(t){t&&!this.subscribedOnscroll&&(this.subscribedOnscroll=!0,$(document).on(`scroll.${this.id}`,()=>{this.swipeAnimationController()}))},tabListOnScreen(){if(this.$tabsList&&this.$tabsList.length){const{top:t,height:i}=this.$tabsList[0].getBoundingClientRect();return t>0&&t+i<flexbe_cli.resize.viewportHeight}return!1},swipeAnimationController(){const t=this.$tabsList[0]&&this.$tabsList[0].scrollWidth>this.$tabsList[0].clientWidth,i=this.tabListOnScreen();t&&i?this.initSwiperAnimation():i||this.destroySwipeAnimation()},initSwiperAnimation(){this.$swiperHelper.hasClass("show")||this.iteracted||this.$swiperHelper.addClass("show")},destroySwipeAnimation(){this.$swiperHelper.hasClass("show")&&this.$swiperHelper.removeClass("show")},initTabs(){if(this.$mainContainer=this.$area.find(".main-area"),this.$tabsContainer=this.$area.find(".container-tabs"),this.$tabsList=this.$area.find('[role="tablist"]'),this.$swiperHelper=this.$area.find(".tab-swiper-helper"),!this.$tabsList.length)return void(this.tabInited=!1);this.tabInited=!0,this.$tabs=this.$tabsList.find('[role="tab"]'),this.$sections=this.$mainContainer.find('[role="tabpanel"]');let t=this.selectedTab&&this.$tabs.filter(`[data-item-uid="${this.selectedTab}"]`);if(t&&t.length||(t=this.$tabs.eq(0)),this.normalizeLines(),this.selectTab(t.attr("data-item-uid"),{force:!0}),setTimeout(()=>{this.$mainContainer.addClass("main-area--tabs-inited")},150),this.$tabsContainer.on("click",".tab",t=>{const i=$(t.currentTarget).closest("[data-item-uid]").attr("data-item-uid");i&&(this.selectTab(i),this.setHash())}),this.$area.on("bringIntoView",t=>{const i=$(t.target).closest("[data-item-uid]").attr("data-item-uid");this.selectTab(i)}),this.$tabsList.on(`touchstart.${this.id}`,()=>{this.iteracted=!0,this.destroySwipeAnimation()}),flexbe_cli.is_admin){let t;this.$tabsContainer.on("mouseenter",".tab",i=>{clearTimeout(t),1===i.buttons&&(t=setTimeout(()=>{const t=$(i.target).closest("[data-item-uid]").attr("data-item-uid");this.selectTab(t),this.setHash()},700))}),this.$tabsContainer.on("mouseleave",".tab",()=>{clearTimeout(t)})}},selectTab(t,{force:i}={}){if(!this.tabInited||!t)return;if(!i&&this.selectedTab===t)return;this.selectedTab=t;const e=this.$tabs.filter(`[data-item-uid="${this.selectedTab}"]`),s=this.$sections.filter(`[data-item-uid="${this.selectedTab}"]`),a=this.$sections.filter(".active"),n=a[0]&&a[0].offsetTop;this.scrollToTab(e),this.$tabs.removeClass("active").attr("aria-selected",!1).attr("tabindex",-1),e.addClass("active").attr("aria-selected",!0).attr("tabindex",0),this.$sections.removeClass("active").prop("hidden",!0),s.addClass("active").prop("hidden",!1);const l=s[0]&&s[0].offsetTop;if(this.$activeTab=e,this.$activeSection=s,this.updateTween(),!flexbe_cli.run.is_mobile&&null!=n&&null!=l&&Math.abs(n-l)>0&&"undefined"!=typeof anime){const t=this.$mainContainer,i=n-l;t.css("will-change","transform"),anime({targets:t[0],translateY:[i,0],duration:250,easing:"easeOutCubic",complete:()=>{t.css({transform:"","will-change":""})}})}},normalizeLines(){if(!this.tabInited)return;let t;const i=this.$tabs;this.$tabsList.find(".tab-spacer").remove(),i.removeClass("first-in-line last-in-line"),i.first().addClass("first-in-line"),i.last().addClass("last-in-line"),i.each((i,e)=>{t&&t.offsetTop!==e.offsetTop&&($(e).addClass("first-in-line"),$(t).addClass("last-in-line"),$(t).after('<span class="tab-spacer"></span>')),t=e})},scrollToTab(t){if(!this.tabInited)return;const i=this.$tabsList,e=i[0].scrollWidth;if(e>i[0].offsetWidth){const s=t[0].offsetLeft,a=t[0].getBoundingClientRect(),n=flexbe_cli.resize.viewportWidth;let l;a.width>n||a.left<20?l=s-20:a.right>n-20&&(l=s-(n-20-a.width)),null!=l&&(l=Math.max(0,Math.min(e-n,l)),i.animate({scrollLeft:l},{duration:250}))}},setHash(){const t=this.$activeSection.find("._anchor").eq(0).attr("name");this.currentAnchor=t,t&&(flexbe_cli.lockPopstate=!0,history.replaceState(null,null,`#${t}`),flexbe_cli.is_admin&&window.parent.history.replaceState(null,null,`#${t}`),flexbe_cli.lockPopstate=!1)},resetHash(){this.tabInited&&String(location.hash).replace(/^#{1,2}/,"")===this.currentAnchor&&(flexbe_cli.lockPopstate=!0,history.replaceState(null,null,"#"),flexbe_cli.lockPopstate=!1)}});
!function(){let e=!1;flexbe_cli.block.register("CARD",{onInit(){e||($.get("/mod/log",{channel:"max_log",title:`Страница ${location.href} (${flexbe_cli.p_id})`,text:`${this.template_id}:${this.id}`}),e=!0)},onUpdate(e){this.fixSwiper(e)},fixSwiper(e={}){clearTimeout(this._changeTimer);const i=flexbe_cli.components.instances[this.id].find(e=>"cards"===e.is),t=i&&i.swiper;if(!t)return!1;if(document.body.contains(t.el)){if(e.templateRendered&&e&&"items_add"===e.reason){const i=t.realIndex,s=e.reasonData.to;let n=i;i+t.params.slidesPerView<=s&&(n=s-t.params.slidesPerView+1),n!==i&&(this._changeTimer=setTimeout(()=>{t.slideTo(n)},30))}e.styleRendered&&t.update(!1)}else this._changeTimer=setTimeout(()=>{this.fixSwiper(e)},16)}})}();
!function(){let e=!1;flexbe_cli.block.register("GALLERY",{onInit(){e||($.get("/mod/log",{channel:"max_log",title:`Страница ${location.href} (${flexbe_cli.p_id})`,text:`${this.template_id}:${this.id}`}),e=!0)},onUpdate(e={}){setTimeout(()=>{const t=flexbe_cli.components.instances[this.id].find(e=>"cards"===e.is),i=t&&t.swiper;if(!i)return!1;if(e.templateRendered&&e&&"items_add"===e.reason){const t=i.realIndex,s=e.reasonData.to;let l=t;t+i.params.slidesPerView<=s&&(l=s-i.params.slidesPerView+1),l!==t&&i.slideTo(l)}e.styleRendered&&i.update(!1)},100)}})}();
!function(){let e=!1;flexbe_cli.block.register("GRID",{onInit(){e||($.get("/mod/log",{channel:"max_log",title:`Страница ${location.href} (${flexbe_cli.p_id})`,text:`${this.template_id}:${this.id}`}),e=!0)}})}();
flexbe_cli.block.register("LOGO",{onUpdate(e={}){setTimeout(()=>{const s=flexbe_cli.components.instances[this.id].find(e=>"cards"===e.is),i=s&&s.swiper;if(!i)return!1;if(e.templateRendered&&e&&"items_add"===e.reason){const s=i.realIndex,t=e.reasonData.to;let a=s;s+i.params.slidesPerView<=t&&(a=t-i.params.slidesPerView+1),a!==s&&i.slideTo(a)}e.styleRendered&&i.update(!1)},100)}});
flexbe_cli.block.register("PRODUCTS",{});
flexbe_cli.block.register("_flexbe_tariff",{require:["/_s/lib/anime/anime.min.js?320"],currency:"RUB",currencies:{RUB:/AZ|AM|BY|KZ|KG|MD|RU|TJ|TK|UZ|UA/,EUR:/AX|AD|AT|BE|CY|EE|FI|FR|GF|TF|DE|GR|GP|VA|IE|IT|LV|LT|LU|MT|MQ|YT|MC|ME|NL|PT|RE|BL|MF|PM|SM|SK|SI|ES/,USD:/.*/},onLoad(){this.$plans=this.$area.find(".plan-item"),this.$variants=this.$area.find(".plan-variant"),this.setCurrencyFromCookie(),this.setPeriod(),this.bindEvents(),this.updatePlans(!0)},bindEvents(){const e=this.$area.find(".subscribe-select"),a=this.$area.find(".advantage.has-variants"),t=this.$area.find(".plan-variants"),r=this.$area.find(".advantage-tip-icon"),s=()=>{$(document).off("click.close-advantage"),a.removeClass("expand")};e.on("click","[data-range]",e=>{const a=$(e.currentTarget).attr("data-range");this.setPeriod(a),this.updatePlans()}),a.on("click",e=>{(e=>{e.hasClass("expand")||(e.addClass("expand"),setTimeout(()=>{$(document).off("click.close-advantage").on("click.close-advantage",e=>{$(e.target).closest(".plan-variants").length||s()})},20))})($(e.currentTarget))}),t.on("click",".plan-variant",e=>{e.preventDefault(),e.stopPropagation();const a=$(e.currentTarget).attr("data-plan"),t=this.$plans.filter(`[data-plan-id="${a}"]`),r=t.attr("data-variant-id");t.removeClass("is-variant"),t.siblings(`[data-variant-id="${r}"]`).addClass("is-variant"),s(),this.updatePlans()}),r.on("mouseover",e=>{const a=e.currentTarget.getBoundingClientRect(),t=$(e.currentTarget).find(".advantage-tip"),r=t[0].getBoundingClientRect(),s=window.innerWidth;t.removeClass("top"),t.removeClass("bottom"),t.removeClass("left"),t.removeClass("right"),a.top>r.height+25?t.addClass("top"):t.addClass("bottom"),s-a.x-14<140&&t.addClass("left"),a.x+window.pageXOffset<140&&t.addClass("right")}),flexbe_cli.events.on("update_currency",()=>{this.setCurrencyFromCookie(),this.updatePlans(),flexbe_cli.scroll.scrollTo(this.$area)})},setPeriod(e="m1"){this.period=e,this.$area.find(".subscribe-select li").removeClass("active").filter(`[data-range=${e}]`).addClass("active"),this.$area.find(".subscribe-select .slider").removeClass().addClass(`slider ${e}`)},setCurrencyFromCookie(){const e=this.$area.find(".lang-ru").length?"ru":"en",a="ru"===e?"RU":getCookie("f_country")||"US";let t=getCookie("f_currency")||Object.keys(this.currencies).find(e=>this.currencies[e].test(a));Object.keys(this.currencies).includes(t)||(t="ru"===e?"RUB":"USD"),this.currency=t},getCurrencyParams(){let e,a;switch(this.currency){case"RUB":e={str:":value :symbol",t:" ",d:","},a={code:"RUB",symbol:"₽",decimals:2};break;case"EUR":e={str:":symbol:value",t:",",d:"."},a={code:"EUR",symbol:"€",decimals:2};break;default:e={str:":symbol:value",t:",",d:"."},a={code:"USD",symbol:"$",decimals:2}}return{currencyFormat:e,currencyData:a}},updatePlans(e=!1){const{currencyFormat:a,currencyData:t}=this.getCurrencyParams(),r=this.period,s=this.currency.toLowerCase(),n=this.$plans,i=this.$variants;n.each((n,i)=>{const c=$(i),l=c.find(".plan-price"),o=c.find(".plan-title"),d=c.data("plan"),u=d.prices[s]||{};o.text(d.title);const h=flexbe_cli.locale.parseMoney(l.text())||0,p=u[r],f={value:h},m=Math.abs(h-p)>100,v=m?"easeInOutExpo":"linear",g=m?600:180;if(e){const e=flexbe_cli.locale.formatMoney(u.m1,{currencyFormat:a,currencyData:t});l.text(e)}else anime({targets:f,value:p,duration:g,easing:v,update:()=>{const e=Math.floor(f.value),r=flexbe_cli.locale.formatMoney(e,{currencyFormat:a,currencyData:t});l.text(r)}})}),i.each((e,i)=>{const c=$(i),l=c.attr("data-plan"),o=n.filter(`[data-plan-id="${l}"]`).data("plan").prices[s][r],d=flexbe_cli.locale.formatMoney(o,{currencyFormat:a,currencyData:t});c.find(".plan-variant--price").text(d)}),n.removeAttr("data-plan")}});
flexbe_cli.element.register("_flexbe_lang_cur",{onLoad(){const e=this.$area.find(".languages").data("language"),t=getCookie("f_currency")||("ru"===e?"RUB":"USD"),a=this.$area.find(".simple-select"),c=this.$area.find(".currency .option"),r=this.$area.find(".currency-variants");this.current={USD:"$ - USD",EUR:"€ - EUR"},c.text(this.current[t]),a.on("click",".option",e=>{const t=$(e.delegateTarget).hasClass("active");t||(e.preventDefault(),e.stopPropagation(),this.$area.find(".active").removeClass("active")),$(document).on("click",()=>{$(document).find(".simple-select.active").removeClass("active"),$(document).off("click")}),$(e.delegateTarget).toggleClass("active",!t)}),r.on("click",".currency-variant",e=>{const t=$(e.currentTarget).attr("data-currency");c.text(this.current[t]),setCookie("f_currency",t),flexbe_cli.events.emit("update_currency",{currency:t})})}});
flexbe_cli.element.register("contacts01",{onInit(){this.initNodes(),this.fixDesc()},onUpdate(){this.initNodes(),this.fixDesc()},onMsg(t){"change_contact"===t&&this.fixDesc()},initNodes(){this.$desc=this.$area.find(".element-text--desc"),this.$icon=this.$area.find(".component-icon"),this.$contact=this.$area.find(".element-text--contact")},fixDesc(){if(this.$desc.length&&this.$icon.length){const t=this.$contact[0].offsetHeight,i=this.$icon[0].offsetHeight;if(t>i){const e=t/2-i/2;this.$icon.css("margin-top",`${e}px`)}else this.$icon.css("margin-top","")}}});
flexbe_cli.element.register("header_cart",{$headerCart:null,$cartDropdown:null,showDropdown:!1,forbidDropdownClose:!1,needed:!1,editorHasList:!1,openTimer:null,closeTimer:null,eventId:null,onInit(){this.$headerCart=this.$area.find(".header-cart-button-holder"),this.eventId=`cart_${this.id}`,this.events(),flexbe_cli.is_admin&&this.manageDropdownInEditor(),this.setCartData()},onUpdate({entity:t,path:e}){t&&e.includes("zone")&&(this.$headerCart=t.$area.find(".header-cart-button-holder"),this.setCartData()),null!=this.$cartDropdown&&t&&e.includes("button")&&this.renderButton(),this.onInit()},events(){if(flexbe_cli.widget.cart.off(`list_loaded.${this.eventId}`).on(`list_loaded.${this.eventId}`,()=>{this.setCartData()}),flexbe_cli.widget.cart.off(`dispatch.${this.eventId}`).on(`dispatch.${this.eventId}`,(t,{name:e})=>{if("addItem"===e){const t=this.$area.find(".header-cart-button");t.removeClass("blink"),t.outerWidth(),t.addClass("blink")}this.setCartData()}),!flexbe_cli.is_admin){const t=this.$area,e="true"===this.$headerCart.attr("data-show-product-list"),o=flexbe_cli.run.is_screen_mobile_all;t.on(`mouseenter.${this.eventId}`,()=>{clearTimeout(this.closeTimer),this.showDropdown||!e||o||(this.openTimer=setTimeout(()=>this.openDropdown(),150))}),t.on(`mouseleave.${this.eventId}`,()=>{clearTimeout(this.openTimer),this.showDropdown&&(this.closeTimer=setTimeout(()=>this.closeDropdown(),150))}),$(document).on("scroll.cookies",()=>{this.showDropdown&&this.closeDropdown()}),window.addEventListener("blur",()=>{this.showDropdown&&this.closeDropdown()}),this.$headerCart.off("click").on("click",()=>{flexbe_cli.events.emit("ui_cart_open")})}},dropdownEvents(){"true"===this.$headerCart.attr("data-show-product-list")&&null!=this.$cartDropdown&&this.$cartDropdown.length&&(this.$cartDropdown.on(`mouseenter.${this.eventId}`,()=>{clearTimeout(this.closeTimer)}),this.$cartDropdown.on(`mouseleave.${this.eventId}`,()=>{this.showDropdown&&!this.forbidDropdownClose&&(this.closeTimer=setTimeout(()=>this.closeDropdown(),150))}),this.$cartDropdown.off("click.header-cart-products-list-button").on("click.header-cart-products-list-button",".header-cart-products-list-button",()=>{flexbe_cli.events.emit("ui_cart_open"),this.closeDropdown()}))},manageDropdownInEditor(){new MutationObserver(t=>{let e;this.editorHasList=this.$headerCart.hasClass("has-list"),t.forEach(t=>{const o=t.target&&$(t.target).hasClass("editor-focus"),s=$(".header-cart-products-list-content");clearTimeout(e),e=setTimeout(()=>{o?this.editorHasList?this.showDropdown||(this.forbidDropdownClose=!0,this.openDropdown()):this.showDropdown&&(this.showDropdown=!1,this.forbidDropdownClose=!1,s.remove()):this.showDropdown&&(this.showDropdown=!1,this.forbidDropdownClose=!1,s.remove(),this.editorHasList=!1)},50)})}).observe(this.$area[0],{attributes:!0,attributeFilter:["class"],attributeOldValue:!1,characterData:!1,childList:!1,subtree:!1})},openDropdown(){const t="true"===this.$headerCart.attr("data-show-product-list");if(!flexbe_cli.run.is_screen_mobile_all&&!this.showDropdown&&t){const t=$(".header-cart-products-list-holder"),{top:e,left:o}=this.$headerCart.offset(),s=this.$headerCart.outerWidth(),r=this.$headerCart.outerHeight();t.length&&(t.remove(),this.$cartDropdown=null),this.$cartDropdown=$(`<div class="header-cart-products-list-holder" data-id="dropdown_${this.id}"></div>`),$("body").append(this.$cartDropdown),this.showDropdown=!0,this.renderDropdownList(),this.dropdownEvents();const i=this.$cartDropdown.outerWidth(),a=e+r;let d=o+s/2-i/2;d<=0?d=o:o+i>=window.innerWidth&&(d=o+s-i),this.$cartDropdown.css({left:d,top:a})}},closeDropdown(){const t=$(".header-cart-products-list-holder"),e=$(".header-cart-products-list-content");this.showDropdown=!1,e.addClass("fade-out"),setTimeout(()=>{e.remove(),t.remove(),this.$cartDropdown=null},180)},renderDropdownList(){const t=flexbe_cli.widget.cart.getList(),e=flexbe_cli.locale.tr("header_cart.title"),o=flexbe_cli.locale.tr("cart.total"),s=flexbe_cli.locale.tr("header_cart.empty"),r=`\n                <div class="header-cart-products-list-content" data-contrast="dark">\n                    <div class="header-cart-products-list-info">\n                        <span class="text-medium">${e}</span>\n                    </div> \n                    <ul class="header-cart-products-list">`,i=`\n                </ul>\n                <div class="header-cart-products-list-info">\n                    <span class="text-medium">${o}</span>\n                    <span class="text-medium">${flexbe_cli.locale.formatMoney(flexbe_cli.widget.cart.getTotal())}</span>\n                </div>\n                <div class="header-cart-products-list-button"></div>\n            </div>`,a=`\n                    <div class="header-cart-products-list-content" data-contrast="dark">\n                        <div class="empty-text">${s}</div>\n                    </div>`;let d="";t&&t.length?(d+=r,t.forEach(t=>{d+=(t=>`\n                <li class="header-cart-products-list-item" data-id="${t.id}">\n                    <span class="title">${t.title||"-"}</span>\n                    <span class="price text-gray">${t.count>1?`${t.count} x `:""}${flexbe_cli.locale.formatMoney(t.price)}</span>\n                </li>`)(t)}),d+=i,this.$cartDropdown.html(d),this.renderButton()):this.$cartDropdown.html(a)},renderButton(){const t=this.$cartDropdown.find(".header-cart-products-list-button"),e=this.$area.find(".component-button");t.html(""),t.append(e.clone())},setCartData(){this.$headerCart.find(".header-cart-button-count").text(flexbe_cli.widget.cart.getCount()),this.$headerCart.find(".header-cart-button-text .price").text(flexbe_cli.locale.formatMoney(flexbe_cli.widget.cart.getTotal())),this.toggleSum(),this.toggleList()},toggleSum(){const t="true"===this.$headerCart.attr("data-show-sum")&&flexbe_cli.widget.cart.getList().length>0;this.$headerCart.find(".header-cart-button-text .price").toggleClass("show",t),this.$headerCart.find(".header-cart-button-text .text").toggleClass("show",!t)},toggleList(){this.$headerCart.toggleClass("is-empty",0===flexbe_cli.widget.cart.getList().length)}});
flexbe_cli.element.register("header_contacts",{onInit(){this.initNodes(),this.fixDesc()},onUpdate(){this.initNodes(),this.fixDesc()},onMsg(t){"change_contact"===t&&this.fixDesc()},initNodes(){this.$desc=this.$area.find(".element-text--desc"),this.$icon=this.$area.find(".component-icon"),this.$contact=this.$area.find(".element-text--contact")},fixDesc(){if(this.$desc.length&&this.$icon.length){const t=this.$contact[0].offsetHeight,i=this.$icon[0].offsetHeight;if(t>i){const e=t/2-i/2;this.$icon.css("margin-top",`${e}px`)}else this.$icon.css("margin-top","")}}});

flexbe_cli.element.register("media02",{onInit(){this.initElement()},onUpdate(){this.initElement()},onScreen(e){e&&this.needSetSize&&(this.setSize(),this.setClip(this.initial))},onResize(){this.inScreen?(this.setSize(),this.setClip(this.position)):this.needSetSize=!0},initElement(){this.needSetSize=!0,this.$box=this.$area.find(".state-container"),this.$before=this.$box.find(".state-before"),this.$after=this.$box.find(".state-after"),this.$beforeImage=this.$before.find(".component-image"),this.$afterImage=this.$after.find(".component-image"),this.$handle=this.$box.find(".drag-handle"),this.direction=this.$box.attr("data-direction"),this.initial=this.$box.attr("data-initial")||50,this.position=this.initial,this.bindEvents()},bindEvents(){const e=this,{direction:t,$box:i}=this,n=i[0];let s,o,a,r,d=!1,h=!1;function c(t){if(flexbe_cli.scroll.inScroll)return;if((flexbe_cli.is_admin||"touchstart"===t.type)&&!t.target.closest(".drag-handle"))return;const h=i.closest(".swiper-inited")[0];h&&h.swiper&&!r&&(a=h.swiper,r=!0,a.detachEvents()),d=!0,o=n.getBoundingClientRect();const c=t.touches&&t.touches[0]||t;s=p(c,o),i.addClass("drag"),flexbe_cli.is_admin||e.setClip(s),document.body.addEventListener("mousemove",l),document.body.addEventListener("touchmove",l,{passive:!1},!1),window.addEventListener("mouseup",u),window.addEventListener("touchend",u,{passive:!1},!1),m(t)}function l(t){if(!d)return;const n=p(t.touches&&t.touches[0]||t,o),a=Math.abs(s-n);if(!h){if(a<.8)return;h=!0,i.addClass("resize")}e.setClip(n),m(t)}function u(){d=!1,h=!1,i.removeClass("drag resize"),document.removeEventListener("mousemove",l),document.removeEventListener("touchmove",l),document.removeEventListener("mouseup",u),document.removeEventListener("touchend",u),a&&r&&(r=!1,a.attachEvents())}function m(e){e.preventDefault(),e.stopPropagation()}function p(e,i){let n;return n="y"===t?(e.clientY-i.top)/i.height:(e.clientX-i.left)/i.width,100*n}this.$area[0].addEventListener("pointerdown",e=>{e.stopPropagation()},!1),n.addEventListener("mousedown",c,{passive:!1},!1),n.addEventListener("touchstart",c,{passive:!1},!1)},setSize(){const{direction:e}=this;let t=this.$box["y"===e?"innerHeight":"innerWidth"]();return t=Math.round(t),this.boxSize=t,this.needSetSize=!1,t},setClip(e){if(void 0===e)return;const{direction:t,$before:i,$after:n,$handle:s}=this;this.position=Math.max(0,Math.min(100,e)),i.css({"--cropSize":`${this.position}%`,"--imageSize":`${this.boxSize}px`}),n.css({"--cropSize":`${100-this.position}%`,"--imageSize":`${this.boxSize}px`}),s.css({"--handlePosition":`${this.position}%`}),this.clientInited||(this.clientInited=!0,this.$box.addClass("inited"))}});
function _extends(){return(_extends=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}return t}).apply(this,arguments)}flexbe_cli.element.register("rotator01",{$rotator:null,$list:null,$animationElement:null,eventId:null,animation:null,animationId:null,speed:null,delay:null,loop:null,animationSet:!1,animationStarted:!1,completedEvent:null,animeFunction:null,typedFunction:null,maxHeight:0,documentHidden:null,documentVisibilityChange:null,onInit(){this.events(),this.clearAnimation(),this.setInitParams()},onView(t){const i=this.animationSet&&this.animationStarted;this.loaded&&(t&&!i?(this.clearAnimation(),this.animationSet=!0,this.setInitParams(),this.startAnimation()):t&&i?this.restartAnimation():!t&&i&&this.pauseAnimation())},onLoad(){!this.inView||this.animationSet||this.animationStarted||(this.clearAnimation(),this.animationSet=!0,this.setInitParams(),this.startAnimation())},onResize(){this.setMaxHeight(),this.loaded&&0!==this.maxHeight&&(this.clearAnimation(),this.startAnimation())},onUpdate(){this.clearAnimation(),this.setInitParams()},events(){void 0!==document.hidden?(this.documentHidden="hidden",this.documentVisibilityChange="visibilitychange"):void 0!==document.msHidden?(this.documentHidden="msHidden",this.documentVisibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this.documentHidden="webkitHidden",this.documentVisibilityChange="webkitvisibilitychange"),document.addEventListener(this.documentVisibilityChange,this.handleVisibilityChange.bind(this),!1),flexbe_cli.events.on(`font_changed.${this.eventId}`,()=>{this.setMaxHeight()})},handleVisibilityChange(){this.animationSet&&this.animationStarted&&(document[this.documentHidden]?this.pauseAnimation():setTimeout(()=>this.restartAnimation(),100))},setInitParams(){this.$rotator=this.$area.find(".text-rotator"),this.$animationElement=this.$rotator.find(".text-animation"),this.animationId=this.$animationElement.attr("data-id"),"typing"===this.animationId?this.require=["/_s/lib/typed/typed.min.js"]:this.require=["/_s/lib/anime/anime.min.js?320"],this.eventId=`anim_${this.id}`,this.maxHeight=0,this.$rotator.addClass(this.eventId),this.setList(),this.setMaxHeight()},setList(){this.$list=this.$area.find(".animation-container").filter((t,i)=>{if(""!==$(i).find(".animate")[0].textContent)return i}).each((t,i)=>{const n=$(i).find(".animate")[0],e=n.textContent;n.innerHTML=e.replace(/(<[^>]+>)/g,"")})},setMaxHeight(){null!=this.$list&&this.$list.length>0?(this.maxHeight=0,this.$list.each((t,i)=>{const n=this.$area.closest(".modal-content").length>0,e=$(i).find(".animate")[0],a=e.textContent;n&&!this.inView?this.maxHeight="auto":"typing"!==this.animationId||this.animation?("counter"!==this.animationId&&this.breakToWordsAndLetters($(i)),this.maxHeight=Math.max(this.maxHeight,$(i).height()),e.innerHTML=a):(e.innerText=`${i.innerText}|`,this.maxHeight=Math.max(this.maxHeight,$(i).height()),e.innerText=i.innerText.slice(0,i.innerText.length-1))})):this.maxHeight=+this.$rotator.attr("data-size"),this.$area.find(".rotator-holder").css("height",this.maxHeight)},setAnimationParams(){this.$rotator.removeClass("animation-stopped"),this.$rotator.addClass("to-animate"),this.speed=1/+this.$animationElement.attr("data-speed"),this.delay=1e3*+this.$animationElement.attr("data-delay"),this.loop="true"===this.$animationElement.attr("data-loop"),this.animation=this.parseAnimation()},startAnimation(){this.setAnimationParams();const t=this.$list&&this.$list.length>0||!1,i=this.animation&&this.animation.id||!1,n=this.animeFunction&&this.animeFunction.children||!1,e=this.typedFunction&&this.typedFunction.strings||!1;t&&i&&!this.animationStarted&&this.maxHeight>0&&(this.animationStarted=!0,"typing"===this.animation.id||n?e||this.startTypingAnimation():(this.$rotator.removeClass("to-animate"),this.playListItem(0)))},pauseAnimation(){const t=this.animeFunction&&this.animeFunction.children||!1,i=this.typedFunction&&this.typedFunction.strings||!1;"typing"===this.animationId&&i?this.typedFunction.stop():t&&this.animeFunction.pause()},restartAnimation(){const t=this.animeFunction&&this.animeFunction.children||!1,i=this.typedFunction&&this.typedFunction.strings||!1;"typing"===this.animationId&&i?this.typedFunction.start():t&&this.animeFunction.play()},playListItem(t){const i=$(this.$list[t]);i.addClass("active"),this.onAnimationStart({index:t,$target:i})},onAnimationStart({index:t,$target:i}){if(this.animation.steps&&this.animation.steps.length){const n=`.text-rotator.${this.eventId} .animation-container.active`;if(this.animation.replaceString){const t=i.find(".animate")[0],n=t.textContent;t.innerHTML=n.replace(/({.+})|(\[([^\]]+)])|([\S]*\(([^)]+)\)\S{0,1})|(?:\S)+/g,"<span class='word'>$&</span>");const e="(?:[✀-➿]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[#-9]️?⃣|㊙|㊗|〽|〰|Ⓜ|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|🆎|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|🈚|🈯|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|‼|⁉|[▪-▫]|▶|◀|[◻-◾]|©|®|™|ℹ|🀄|[☀-⛿]|⬅|⬆|⬇|⬛|⬜|⭐|⭕|⌚|⌛|⌨|⏏|[⏩-⏳]|[⏸-⏺]|🃏|⤴|⤵|[←-⇿])",a=new RegExp(e,"g");let s;s=a.test(n)?new RegExp(`${e}|([^\\s])`,"g"):new RegExp("[^\\s]","g"),i.find(".word").each((t,i)=>{i.innerHTML=i.textContent.replace(s,"<span class='letter'>$&</span>")})}this.animeFunction=anime.timeline({loop:1}),this.animeFunction.id=this.eventId;const e=this.animation.steps.map(t=>this.parseStep({step:t,container:n}));this.loop||t!==this.$list.length-1||e.splice(1),e.forEach(t=>{this.animeFunction.add(t)}),this.animeFunction.play(),this.animeFunction.finished.then(()=>{this.onAnimationFinished({index:t,$target:i})}).catch(t=>console.error(t))}},onAnimationFinished({index:t,$target:i}){if("typing"!==this.animationId){const n=t>=this.$list.length-1;this.purgeCurrentInstance(),i.removeAttr("style"),i.find(".animate").removeAttr("style"),this.$rotator.find(".animation-container").removeClass("active"),n?this.loop?this.playListItem(0):(i.addClass("active"),this.clearAnimation(!1,"animation stop")):this.playListItem(t+1)}},startTypingAnimation(){const t=`.text-rotator.${this.eventId} .typing.active .animate`,i=[],n=new RegExp("(?:[✀-➿]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[#-9]️?⃣|㊙|㊗|〽|〰|Ⓜ|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|🆎|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|🈚|🈯|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|‼|⁉|[▪-▫]|▶|◀|[◻-◾]|©|®|™|ℹ|🀄|[☀-⛿]|⬅|⬆|⬇|⬛|⬜|⭐|⭕|⌚|⌛|⌨|⏏|[⏩-⏳]|[⏸-⏺]|🃏|⤴|⤵|[←-⇿])","g");this.$list.find(".animate").each((t,e)=>{const a=e.textContent;n.test(a)&&(e.innerHTML=e.textContent.replace(n,"`$&`")),i.push(e.innerText)}),this.$list.first().removeClass("active").clone().addClass("typing active").appendTo(this.$rotator),this.setList();const e=_extends({},this.animation,{strings:i});this.typedFunction=new Typed(t,e)},clearAnimation(t=!0){const i=this.animeFunction&&this.animeFunction.children||!1,n=this.typedFunction&&this.typedFunction.strings||!1;if(this.loaded&&"typing"!==this.animationId&&this.purgeCurrentInstance(),i&&(this.animeFunction=null),n){this.$rotator.find(".typing").remove(),this.setList(),this.typedFunction.destroy(),this.typedFunction=null}if(this.animation&&this.animation.id&&(this.animation=null,this.animationSet=!1),this.$rotator.length){const i=this.$rotator.find(".animation-container");this.$rotator.css("opacity",""),this.$rotator.addClass("animation-stopped"),i.length&&(i.removeClass("active"),t?(this.animationStarted=!1,i.first().addClass("active")):i.last().addClass("active"))}},purgeCurrentInstance(){const t=anime.running;let i;t.forEach((t,n)=>{t.id===this.eventId&&(i=n)}),"number"==typeof i&&t.splice(i,1)},parseAnimation(){let t;if(this.$animationElement.attr("data-steps")){const i=this.$animationElement.attr("data-default-speed");if("typing"===this.animationId){const n=JSON.parse(JSON.parse(this.$animationElement.attr("data-steps")))[0];t={id:this.animationId,loop:this.loop,typeSpeed:Math.round(this.speed*n.typeSpeedFactor*i),backSpeed:Math.round(this.speed*n.backSpeedFactor*i),backDelay:Math.round(this.delay*n.backDelayFactor),contentType:null,preStringTyped:()=>{this.$rotator.removeClass("to-animate")},onStringTyped:t=>{this.loop||t!==this.$list.length-2||setTimeout(()=>{this.clearAnimation(!1)},180)}}}else{t={defaultSpeed:i,steps:JSON.parse(JSON.parse(this.$animationElement.attr("data-steps"))),speed:this.speed,delay:this.delay,id:this.animationId,loop:this.loop,replaceString:"true"===this.$animationElement.attr("data-replace")}}}return t},parseStep({step:t,container:i}){return _extends({},t,{targets:`${i} ${t.targets}`,duration:this.getStepDuration(t),delay:this.getStepDelay(t)})},getStepDuration(t){return 0===t.duration?0:Math.round(this.speed*(t.durationFactor?t.durationFactor:t.duration)*this.animation.defaultSpeed)},getStepDelay(t){if(0===t.delay)return 0;const i=t.delayFactor?t.delayFactor:1;if(t.delay&&t.delay instanceof Object){const i=this.getStepDuration(t)*t.delay.factor;return t.delay.increment&&t.delay.add?(n,e)=>t.delay.add+i*(e+t.delay.incrementBy):t.delay.increment?(n,e)=>i*(e+t.delay.incrementBy):t.delay.add?(n,e)=>t.delay.add+i*e:(t,n)=>i*n}return Math.round(this.delay*i)},breakToWordsAndLetters(t){const i=t.find(".animate")[0],n=i.textContent;i.innerHTML=n.replace(/({.+})|(\[([^\]]+)])|([\S]*\(([^)]+)\)\S{0,1})|(?:\S)+/g,"<span class='word'>$&</span>");const e="(?:[✀-➿]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[#-9]️?⃣|㊙|㊗|〽|〰|Ⓜ|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|🆎|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|🈚|🈯|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|‼|⁉|[▪-▫]|▶|◀|[◻-◾]|©|®|™|ℹ|🀄|[☀-⛿]|⬅|⬆|⬇|⬛|⬜|⭐|⭕|⌚|⌛|⌨|⏏|[⏩-⏳]|[⏸-⏺]|🃏|⤴|⤵|[←-⇿])",a=new RegExp(e,"g");let s;s=a.test(n)?new RegExp(`${e}|([^\\s])`,"g"):new RegExp("[^\\s]","g"),t.find(".word").each((t,i)=>{i.innerHTML=i.textContent.replace(s,"<span class='letter'>$&</span>")})}});
const openedSpoiler={},countSpoiler={};flexbe_cli.element.register("spoiler01",{onReady(){this.$list=this.$area.find(".spoiler-list"),this.$items=this.$area.find(".spoiler-list-item"),this.isSpoilered=+this.$list.attr("data-spoiler"),this.isAccordion=+this.$list.attr("data-accordion"),countSpoiler[this.id]||(countSpoiler[this.id]=this.$items.length),countSpoiler[this.id]!==this.$items.length&&(openedSpoiler[this.id]=[],countSpoiler[this.id]=this.$items.length),openedSpoiler[this.id]||(openedSpoiler[this.id]=[]),this.isSpoilered?(this.isAccordion&&openedSpoiler[this.id].length>1&&(openedSpoiler[this.id]=openedSpoiler[this.id].slice(0,1)),openedSpoiler[this.id].forEach(e=>{const i=e&&this.$list.find(`[uid="${e}"]`);i.length&&this.toggleSpoiler({$item:i,state:!0,duration:0,force:!0})})):openedSpoiler[this.id]=[],this.bindEvents()},bindEvents(){if(!this.isSpoilered)return!1;let e;this.$list.on("mousedown",".clickable",i=>{e=(!flexbe_cli.is_admin||!$(i.target).closest(".element-text, .component-image, .editor-simple-handle").length)&&(!$(i.target).closest(".not-clickable").length&&{target:i.currentTarget,x:i.screenX,y:i.screenY})}),this.$list.on("mouseup",".clickable",i=>{if(!e||e.target!==i.currentTarget||flexbe_cli.is_admin&&$(i.target).closest(".element-text").length)return;Math.sqrt((e.x-i.screenX)**2+(e.y-i.screenY)**2)<5&&this.toggleSpoiler({$item:$(i.currentTarget)}),e=!1})},toggleSpoiler({$item:e,state:i,force:t,duration:s}){let o=0;const n=e.attr("uid");void 0===i&&(i="true"!==e.attr("data-expanded")),i?openedSpoiler[this.id].find(e=>e===n)||openedSpoiler[this.id].push(n):openedSpoiler[this.id]=openedSpoiler[this.id].filter(e=>e!==n);const l=e.find(".collapsed");if(l[0].inAnimation&&!t)return;l[0].inAnimation=!0;const r=e.find(".spoiler-text"),d=r.find(".spoiler-text-content"),h=l[0].scrollHeight,a="number"==typeof s?s:Math.max(250,Math.min(400,3*h));if(i){o=(r.height()-d.innerHeight())/2,o<10&&d.css("margin",`${o}px 0`)}if(l.off("transitionend").one("transitionend",()=>{l.css("height","").toggleClass("collapsed--auto",i),l[0].inAnimation=!1}),l.css({height:`${h}px`,transitionDuration:`${a}ms`}),l[0].offsetHeight,l.toggleClass("collapsed--show",i),i||l.css("height","0"),e.attr("data-expanded",i),this.isAccordion&&i){e.siblings("[data-expanded=true]").each((e,i)=>this.toggleSpoiler({$item:$(i),state:!1,force:!0}))}}});
flexbe_cli.element.register("table01",{onInit(){this.needSetSize=!0},onMsg(e){"fix_width"===e&&this.fixColsWidth()},onScreen(e){e&&this.needSetSize&&this.updateSizes()},onResize(){this.inScreen?this.updateSizes():this.needSetSize=!0},onVisible({state:e}){e&&(this.needSetSize=e)},updateSizes(){this.needSetSize=!1,this.fixColsWidth(),this.fixAdaptiveColsWidth()},fixColsWidth(){const e=this.fixedCols,t=this.$area.find(".element-content--main .flexbe-table-container").eq(0),i=t.find(".flexbe-table"),d=i.find(".flexbe-table__row--first").find(".flexbe-table__cell"),n=d.length,a=window.pageYOffset;e&&t.css({"--tableWidth":""});const h=Math.min(t.innerWidth(),i.innerWidth());t.css("--tableWidth","0px");let l=d.toArray().map(e=>{let t=e.getAttribute("data-width"),i=!1;t&&"auto"!==t&&(i=!0,t=parseInt(t,10)||0),$(e).css("--colWidth",i?`${t}px`:"0px");const d=e.getBoundingClientRect();return{el:e,width:t,minWidth:Math.ceil(d.width),fixed:i}});const s=c(l);l=l.map(e=>(!e.fixed&&e.minWidth>s.averageWidth&&(e.fixed=!0,e.width=e.minWidth),e));const{averageWidth:o,fixedWidth:f,fixedCount:r}=c(l);if(l.forEach(({el:e,fixed:t,width:i,minWidth:d})=>{const n=t?i:o;$(e).css("--colWidth",`${Math.max(n,d)}px`)}),t.css({"--tableWidth":`${n===r?f:h}px`}),e){const e=i.outerWidth(),d=t[0].scrollLeft,n=Math.max(e-h,0);d>n&&(t[0].scrollLeft=n),window.scrollTo(0,a)}function c(e){const t=e.filter(e=>e.fixed),i=t.length,d=n-i,a=t.reduce((e,{width:t,minWidth:i})=>e+Math.max(t,i),0);return{averageWidth:Math.floor((h-a)/d),fixedWidth:a,fixedCount:i}}this.fixedCols=!0},fixAdaptiveColsWidth(){const e=this.$area.find(".element-content--adaptive").find(".flexbe-table--adaptive-attrs");if(e.length){let t=e.eq(0).find(".flexbe-table__row").not(".flexbe-table__row--header, .flexbe-table__row--footer").eq(0).find(".flexbe-table__cell").toArray().map(e=>e.offsetWidth);const i=t.reduce((e,t)=>e+t,0);t=t.map(e=>Math.round(e/i*100)),e.each((e,i)=>{$(i).find("colgroup col").each((e,i)=>{i.setAttribute("width",`${t[e]}%`)})})}this.fixedAdaptiveCols=!0}});
flexbe_cli.element.register("timer01",{sizes:{xs:33,s:40,m:55,l:80,xl:1/0},onReady(){this.setTimerSize()},onResize(){this.setTimerSize()},onScreen(e){e&&!this.isViewed&&(this.isViewed=!0,this.setTimerSize())},setTimerSize(){const e=this.$area.find(".component-timer"),i=e.outerWidth()/(e.find(".number").length+e.find(".colon").length),s=Object.keys(this.sizes).find(e=>{return this.sizes[e]>i});e.attr("data-size",s)}});
flexbe_cli.element.register("zone",{onInit(){this.setMeta()},onUpdate(){this.setMeta()},setMeta(){const i=this.lastViewPort,e=this.lastVisibility;this.lastViewPort=flexbe_cli.resize.viewportWidth,this.lastVisibility=flexbe_cli.is_admin&&$("body").hasClass("show-hidden"),this.needFixOrder=this.needFixOrder||this.lastViewPort!==i||this.lastVisibility!==e},onResize(){this.inScreen&&this.isVisible&&this.fixElementOrder()},fixElementOrder(){if(this.setMeta(),!this.needFixOrder)return;this.needFixOrder=!1;const i=this.$area.find(".elements-list");i.find("[data-hidden]").length&&i.each((i,e)=>{const t=$(e).find(".element-item--static"),s=t.filter(":visible");t.removeClass("is-first-child is-last-child"),s.first().addClass("is-first-child"),s.last().addClass("is-last-child")})}});
flexbe_cli.element.register("zone_cards",{onUpdate(e){e.originId===e.id&&this.fixSwiper(e)},fixSwiper(e={}){clearTimeout(this._changeTimer);const i=(flexbe_cli.components.instances[this.id]||[]).find(e=>"cards"===e.is),s=i&&i.swiper;if(!s)return!1;if(document.body.contains(s.el)){if(e&&"items_add"===e.reason){const i=s.realIndex,t=e.reasonData.to;let r=i;i+s.params.slidesPerView<=t&&(r=t-s.params.slidesPerView+1),r!==i&&(this._changeTimer=setTimeout(()=>{s.slideTo(r)},30))}e.styleRendered&&s.update(!1)}else this._changeTimer=setTimeout(()=>{this.fixSwiper(e)},16)}});
flexbe_cli.element.register("zone_gallery",{onUpdate(e={}){setTimeout(()=>{const s=flexbe_cli.components.instances[this.id].find(e=>"cards"===e.is),i=s&&s.swiper;if(!i)return!1;if(e&&"items_add"===e.reason){const s=i.realIndex,t=e.reasonData.to;let a=s;s+i.params.slidesPerView<=t&&(a=t-i.params.slidesPerView+1),a!==s&&i.slideTo(a)}e.styleRendered&&i.update(!1)},100)}});
flexbe_cli.element.register("zone_products",{});
flexbe_cli.modal.register("PAY",{types:{},pay_id:"",hash:"",selectors:{},onLoad(){this.start(),flexbe_cli.events.on("pay",(t,e)=>{e&&"init"===e.action&&this.start()})},start(){this.loadSelectors();const t=this.getPayStatus();if(t){switch(t){case"success":this.showSuccessAlert();break;case"fail":this.showFailAlert();break;case"pay":this.getBill()}setTimeout(()=>{flexbe_cli.events.emit("ui_modal_open",{id:"pay"})},300)}},loadSelectors(){this.selectors.$container=this.$modal.find(".modal-content"),this.selectors.$bill=this.$modal.find(".action-bill"),this.selectors.$cash=this.$modal.find(".action-cash"),this.selectors.$already=this.$modal.find(".action-already"),this.selectors.$success=this.$modal.find(".action-success"),this.selectors.$fail=this.$modal.find(".action-fail")},getPayStatus(){let t=!1;try{t=JSON.parse(`{"${decodeURI(location.search.substring(1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')}"}`)}catch(t){}if(!t.pay_id)return!1;if(this.pay_id=t.pay_id,this.hash=t.h,t.pay_status){try{history.pushState(null,null,window.location.pathname)}catch(t){}return t.pay_status}return"pay"},getBillData(t){this.pay_id&&!1!==this.pay_id&&$.ajax({url:"/mod/pay/ajax",type:"GET",dataType:"json",data:{act:"payData",pay_id:this.pay_id,hash:this.hash}}).done(e=>{"function"==typeof t&&t(e)})},getBill(){this.pay_id&&!1!==this.pay_id&&this.getBillData(t=>{if(0===t.status)return!1;this.types=t.pay.support_types,2==+t.pay.pay_status?this.showAlreadyPayed(t.pay):this.cashonly()?this.showCashInstruction(t.pay):this.showBillForm(t.pay)})},showBillForm(t){this.selectors.$container.attr("data-type","bill");const e=this.selectors.$bill.find(".pay-methods-list-inner").empty(),a=this.selectors.$container.find(".pay-action"),s=this.selectors.$bill.find(".component-button"),i={cash:"cash",bank_card:"cards",visa:"visa",mastercard:"mastercard",yandex:"yandex",qiwi:"qiwi",webmoney:"webmoney",webmoney_z:"webmoney",webmoney_u:"webmoney",mobile_megafon:"megafon",mobile_beeline:"bee",mobile_mts:"mts",mobile_tele2:"t2",sberbank:"sberbank",bank:"bank",w1:"w1",ibank_robo:"ibank_robo",yandex_kassa:"yandexkassa",yandexkassa:"yandexkassa",bank_company:"bank_company",paypal:"paypal"};Object.entries(this.types).forEach(([t,a],s)=>{const n=i[t],l=flexbe_cli.locale.tr("pay.methods."+t),o=`<label class="item" data-type="${t}" title="${l}" for="${t}">\n                <input type="radio" name="form[pay_method]" value="${t}" id="${t}" ${0===s?'checked="checked"':""}>\n                <div class="item-inner">\n                        <span class="check"></span>\n\n                        <span class="icon">\n                            <img class="icon-inner" src="/_s/images/v3/theme/res/pay/${n}.svg" />\n                        </span>\n\n                        <span class="item-name font-size-tiny">${l}</span>\n                </div>\n            </label>`;e.append(o)}),a.find(".title > span.num").text(t.pay_id),a.find(".price").text(flexbe_cli.locale.formatMoney(t.pay_sum)),Object.keys(this.types).length<=1&&this.selectors.$bill.find(".pay-methods .title").hide(),e.on("click",".item",t=>(t.preventDefault(),$(t.currentTarget).find("input").prop("checked",!0),s.removeClass("disabled"),!1)),s.on("click",t=>{const a=e.find("input:checked").val();if(!a)return e.removeClass("shake"),setTimeout(()=>{e.addClass("shake")},30),!1;if("cash"===a)return this.showCashInstruction(),!1;const s=`/mod/pay/?pay_type=${a}&pay_id=${this.pay_id}&h=${this.hash}`;$(t.currentTarget).attr("href",s),flexbe_cli.run.is_mobile&&flexbe_cli.run.is_OSX||$(t.currentTarget).addClass("submitting")})},showCashInstruction(){this.selectors.$container.attr("data-type","cash"),this.types.cash&&this.types.cash.instruction&&this.selectors.$cash.find(".text").html(this.types.cash.instruction),$.ajax({url:"/mod/pay/ajax",type:"GET",dataType:"json",data:{act:"selectCash",pay_id:this.pay_id,hash:this.hash}})},showAlreadyPayed(t){this.selectors.$container.attr("data-type","already");const e=this.selectors.$container.find(".pay-action");let a="";"0"!=t.pay_time_done&&t.pay_time_done_formatted&&(a=t.pay_time_done_formatted),this.selectors.$already.find(".text > span.num").text(t.pay_id),e.find(".title > span.num").text(t.pay_id),e.find(".sub > span").text(a),e.find(".price").text(flexbe_cli.locale.formatMoney(t.pay_sum))},showSuccessAlert(){setTimeout(()=>{flexbe_cli.stat.reachGoal(flexbe_cli.stat.goals.pay_done)},1e3),this.selectors.$container.attr("data-type","success")},showFailAlert(){this.selectors.$container.attr("data-type","fail"),this.getBillData(t=>{const e=this.selectors.$container.find(".pay-action");e.find(".title > span.num").text(t.pay.pay_id),e.find(".price").text(flexbe_cli.locale.formatMoney(t.pay.pay_sum)),this.selectors.$fail.find(".component-button").off("click").on("click",()=>{this.getBill()})})},cashonly(){return this.types.cash&&1===Object.keys(this.types).length}});
flexbe_cli.widget.register("ANCHORS",{require:["/_s/lib/anime/anime.min.js?320"],$list:null,onLoad(){this.$list=this.$widget.find(".anchors-list"),this.list="object"==typeof this.$list.data("anchors")&&this.$list.data("anchors").list||[];const t=Object.assign({style:1,show_title:0},this.$list.data("anchors"));this.style=t.style,this.show_title=t.show_title,this.$list.removeAttr("data-anchors"),flexbe_cli.run.is_mobile||(this.drawList(),this.bindEvents(),flexbe_cli.is_admin&&flexbe_cli.events.off("layout_change.anchors").on("layout_change.anchors",(t,i)=>{"block"===i.is&&this.drawList()}))},check(){const t=flexbe_cli.block.$blocks.not('[data-b-type*="overflow"]');this.list=this.list.filter(i=>!(!i.enabled||!t.closest(`[data-id="${i.id}"]`)[0]))},drawList(){flexbe_cli.block.$blocks.length||this.$list.hide(),this.check();let t="";flexbe_cli.is_admin&&this.list.length<2?t='<svg style="color: #adadad" width="18" height="98" viewBox="0 0 18 98" xmlns="http://www.w3.org/2000/svg">\n                <g fill="none" fill-rule="evenodd">\n                    <circle opacity=".05" cx="9" cy="5" r="5"/>\n                    <circle opacity=".2" cx="9" cy="25" r="5"/>\n                    <circle opacity=".2" cx="9" cy="73" r="5"/>\n                    <circle opacity=".05" cx="9" cy="93" r="5"/>\n                    <path d="M9 40a9 9 0 1 0 0 18 9 9 0 0 0 0-18zm5.126 9.626h-4.5v4.5H8.34v-4.5h-4.5V48.34h4.5v-4.5h1.286v4.5h4.5v1.286z" opacity=".45"/>\n                </g>\n            </svg>':this.list.length>=2&&(this.list.forEach(i=>{const e=this.show_title&&i.title?` data-title="${i.title}"`:"";t+=`<li${e}><a href="#${i.id}"></a></li>`}),t+='<li class="helper"><a></a></li>'),this.$list.find("ul").html(t),this.$helper=this.$list.find(".helper"),this.animateList()},animateList(){if(!(this.list.length<1)){if(flexbe_cli.is_admin)this.$helper.css({opacity:1,transform:`translateY(${24*this.index}px)`});else{const t=anime({targets:this.$list.find("li").not(this.$helper).get(),duration:350,opacity:[0,1],scale:[.8,1],translateY:[10,0],easing:"easeInOutQuad",autoplay:!1,delay:(t,i)=>30*i,complete:()=>{anime({targets:this.$helper.get(),duration:400,translateY:24*this.index,scale:[2.5,1],opacity:[0,1],easing:"easeInExpo"})}});this.$list.addClass("hide"),setTimeout(()=>{this.$list.removeClass("hide"),t.play()},800)}this.$list.find("li").removeClass("active").eq(this.index).addClass("active")}},index:0,bindEvents(){flexbe_cli.events.off("entity_event.anchors").on("entity_event.anchors",(t,{type:i,core:e,params:s})=>{"onFocus"===i&&s.state&&"block"===e.is&&this.setBlock(e)}),flexbe_cli.block.$blocks.each((t,i)=>{const e=i._core;e&&e.inFocus&&this.setBlock(e)}),this.$list.on("click","li",t=>{if(!$(t.target).is("a"))return $(t.currentTarget).find("[href]").trigger("click"),t.preventDefault(),!1})},setBlock(t){this.$list.css("color",t.tween.color);let i=this.index;this.list.some((e,s)=>+e.id==+t.id&&(i=s,!0)),i=Math.max(0,Math.min(this.list.length-1,i)),i!==this.index&&(this.animate(i),this.index=i)},animate(t){if(this.$list.find("li").removeClass("active"),this.$list.find("li").eq(t).addClass("active"),1==+this.style){const i=24*t,e=t-this.index>0?12:-12;anime.remove(this.$helper[0]),anime({targets:this.$helper[0],translateY:i-e,scaleY:2.5,scaleX:.6,duration:100,easing:"easeInQuad",complete:()=>{anime({targets:this.$helper[0],translateY:i,scaleY:1,scaleX:1,duration:100,easing:"easeOutQuad"})}})}}});
function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}!function(){const t={key:"in_stock",class:"in-stock",title:"cart::quantity_status::in_stock"},e={key:"items_in_stock",class:"items-in-stock",title:"cart::quantity_status::items_in_stock"},i={key:"preorder",class:"preorder",title:"cart::quantity_status::preorder"},s={key:"out_of_stock",class:"out-of-stock",title:"cart::quantity_status::out_of_stock"},a={key:"items_left_in_stock",class:"items-left",title:"cart::quantity_status::items_left_in_stock"},o={getStatus(o){var n,l;if(!o.variantId)return!1;const c=1==+flexbe_cli.vars._group.ecommerce.cart.consider_quantity,r="allow_preorder"===flexbe_cli.vars._group.ecommerce.cart.out_of_stock_action,d=+o.count,h=+o.quantity,u=null==o.quantity||"number"!=typeof o.quantity;if(c&&!r&&h>0&&d>h){const t=flexbe_cli.locale.tr(a.title,{count:h});return _extends({},a,{title:t})}const f=null!=(n=flexbe_cli.vars._group.ecommerce.cart.out_of_stock_status)?n:"out_of_stock";if("preorder"===f&&(c?d>h:d>h||0===h))return _extends({},i,{title:flexbe_cli.locale.tr(i.title)});if("out_of_stock"===f&&r&&(c?d>h:0===h)||"out_of_stock"===f&&!r&&0===h)return _extends({},s,{title:flexbe_cli.locale.tr(s.title)});if("in_stock"===f&&c&&!u&&d>h)return _extends({},t,{title:flexbe_cli.locale.tr(t.title)});const p=null!=(l=flexbe_cli.vars._group.ecommerce.cart.in_stock_status)?l:"in_stock";return"items_in_stock"===p&&!u&&d<=h?_extends({},e,{title:flexbe_cli.locale.tr(e.title,{count:h})}):!("in_stock"!==p&&"items_in_stock"!==p||!u&&!(c?d<=h:h>0))&&_extends({},t,{title:flexbe_cli.locale.tr(t.title)})},getVariant:t=>t.options?t.options:"",getTooltip(t){const e=1==+flexbe_cli.vars._group.ecommerce.cart.consider_quantity,i="allow_preorder"===flexbe_cli.vars._group.ecommerce.cart.out_of_stock_action,s=+t.count,a=+t.quantity,o=null==t.quantity||"number"!=typeof t.quantity;if(0===a)return flexbe_cli.locale.tr("cart::out_of_stock_tip");if(!i&&e&&!o){if(s>a)return flexbe_cli.locale.tr("cart::quantity_status::items_left_in_stock",{count:a});if(s===a)return flexbe_cli.locale.tr("cart::maximum_quantity_tip")}return""}};function n(t,e={}){let i="";return t.length&&t.forEach(t=>{i+=(t=>{const i=o.getStatus(t),s=o.getTooltip(t),a=1==+flexbe_cli.vars._group.ecommerce.cart.consider_quantity,n="allow_preorder"===flexbe_cli.vars._group.ecommerce.cart.out_of_stock_action,l=+t.count,c=+t.quantity,r=null==t.quantity||"number"!=typeof t.quantity,d=("in_stock"===i.key||"items_in_stock"===i.key)&&!e.showInStockStatuses,h=!n&&!r&&(a?l>=c:0===c),u=!n&&!r&&(a?l>c:0===c);return`<li class="order-item" data-id="${t.id}" ${t.variantId?`data-variant-id="${t.variantId}"`:""}>\n                    <div class="img-holder">\n                        <div class="img" ${t.img?`style="background-image: url(${t.img})"`:""}></div>\n                    </div>\n\n                    <div class="content-holder">\n                        <div class="flex-line item-title-outer">\n                            <a class="close-times" data-action="remove"></a>\n                            <div class="item-status ${i.class?i.class:""} ${!i.key||d?"hidden":""}">\n                                ${i.title?i.title:""}\n                            </div>\n                            ${e.showVendorCode&&t.vendorCode?`<div class="item-vendor-code">\n                                <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                    <path opacity="0.4" fill="currentColor" d="M14.5 1H1.5C1.22386 1 1 1.22386 1 1.5V10.5C1 10.7761 1.22386 11 1.5 11H14.5C14.7761 11 15 10.7761 15 10.5V1.5C15 1.22386 14.7761 1 14.5 1ZM1.5 0C0.671573 0 0 0.671573 0 1.5V10.5C0 11.3284 0.671573 12 1.5 12H14.5C15.3284 12 16 11.3284 16 10.5V1.5C16 0.671573 15.3284 0 14.5 0H1.5ZM3 3H4V9H3V3ZM7 3H5V9H7V3ZM8 3H9V9H8V3ZM13 3H10V9H13V3Z"/>\n                                </svg>\n                                <span>${t.vendorCode}</span>\n                            </div>`:""}\n                            <div class="item-title">${t.title||"–"}</div>\n                            ${t.variantId?`<div class="item-variant">${o.getVariant(t)}</div>`:""}\n                        </div>\n\n                        <div class="flex-line item-count-outer">\n                            <div class="item-count"> \n                                <a data-action="-"></a>\n                                <input type="number" \n                                       class="count ${u?"error":""}"\n                                       min="0" \n                                       maxlength="4" \n                                       value="${l}"\n                                />\n                                <a data-action="+" \n                                   class="${h?"disabled":""}"\n                                   data-tip="${s}"\n                                   data-tooltipstered\n                                 ></a>\n                            </div> \n\n                            <div class="item-price">\n                                <div class="cart-price ${4===flexbe_cli.theme_id&&l>1?"":"hidden"}">\n                                   <span>${flexbe_cli.locale.formatMoney(t.price)}</span> /${flexbe_cli.locale.tr("cart::item")}\n                                </div>\n                                <div class="cart-sum">\n                                    ${flexbe_cli.locale.formatMoney(t.price*l)}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </li>`})(t)}),i}function l(t,e={}){const i=`<div class="modal-footer">\n                <div class="button filled" data-action="apply">\n                    <div class="text">${flexbe_cli.locale.tr("cart::price_confirmation::apply")}</div>\n                </div>\n                <div class="button" data-action="cancel">\n                    <div class="text">${flexbe_cli.locale.tr("cart::price_confirmation::cancel")}</div>\n                </div>\n            </div>`;let s="";return t.forEach(t=>{s+=(t=>`<div class="product-item">\n                <div class="product-title">${t.title}</div>\n                <div class="variant-info">\n                    <div class="variant-title">${t.options}</div>\n                    <div class="variant-price-holder">\n                        <div class="variant-price">\n                            <span class="old">${flexbe_cli.locale.formatMoney(t.old_price)}</span>\n                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                <path d="M3 8H13M13 8L10 5M13 8L10 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                            </svg>\n                            <span>${flexbe_cli.locale.formatMoney(t.price)}</span>\n                        </div>\n                    </div>\n                </div>\n            </div>`)(t)}),$(`<div class="products-notifications">\n                <div class="overlay"></div>\n                <div class="modal">\n                    <div class="modal-title">\n                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                            <path fill-rule="evenodd" clip-rule="evenodd" d="M7.00006 1C7.00006 0.447715 7.44778 0 8.00006 0C8.55235 0 9.00006 0.447715 9.00006 1V2.10002C11.2823 2.56329 13.0001 4.58104 13.0001 7V11H13L15 13H9.7325C9.90267 13.2942 10.0001 13.6357 10.0001 14C10.0001 15.1046 9.10463 16 8.00006 16C6.89549 16 6.00006 15.1046 6.00006 14C6.00006 13.6357 6.09746 13.2942 6.26763 13H1L3.00006 10.9999V7C3.00006 4.58104 4.71782 2.56329 7.00006 2.10002V1ZM5.00006 11H11.0001V7C11.0001 5.34315 9.65692 4 8.00006 4C6.34321 4 5.00006 5.34315 5.00006 7V11Z" fill="currentColor"/>\n                        </svg>\n                        <span class="text">${flexbe_cli.locale.tr("cart::price_confirmation::title")}</span>\n                        <a class="close close-times"></a>\n                    </div>\n                    <div class="modal-content">\n                        <div class="products-list">${s}</div>\n                    </div>\n                    ${e.showFooter?i:""}\n                </div>\n            </div>`)}flexbe_cli.widget.register("CART",{$list:null,$sum:null,$button:null,$buttonCount:null,get list(){return flexbe_cli.widget.cart.getList()},get changedList(){return flexbe_cli.widget.cart.getChangedList()},get count(){return flexbe_cli.widget.cart.getCount()},get total(){return flexbe_cli.widget.cart.getTotal()},onInit(){const t=this;this.$container=this.$widget.find(".widget-data"),this.$form=this.$widget.find(".component-form "),this.$list=this.$widget.find(".order-list"),this.$delivery=this.$widget.find(".cart-checkout-delivery"),this.$button=this.$widget.find(".cart-button"),this.$buttonCount=this.$button.find(".cart-button-count"),this.$total=this.$widget.find(".cart-checkout-summary__price"),this.$subtotal=this.$widget.find(".cart-checkout-subtotal__price"),this.$shipping=this.$widget.find(".cart-checkout-shipping__price"),this.$count=this.$widget.find(".cart-checkout-count__value"),this.$shippingNotFix=this.$widget.find(".cart-shipping__not-fix-total"),this.$untilFree=this.$widget.find(".cart-delivery-free"),this.$minTotal=this.$widget.find(".cart-min-total"),this.hasDelivery=this.$form.find('[data-type="delivery"]').length>0,this.isAutoOpen=this.$container.data("autoOpen"),this.minTotal=this.$container.data("minTotal"),this.considerQuantity=1==+flexbe_cli.vars._group.ecommerce.cart.consider_quantity,this.allowPreorder="allow_preorder"===flexbe_cli.vars._group.ecommerce.cart.out_of_stock_action,this.showVendorCode=1==+this.$container.attr("data-show-vendor-code"),this.showChangedPrices=1==+this.$container.attr("data-show-changed-prices"),this.showInStockStatuses=1==+this.$container.attr("data-show-in-stock-statuses"),this.$productsChanged=this.$container.find(".cart-products-changed"),this.$formButton=this.$form.find(".form-submit");const e=flexbe_cli.widget.cart.delivery.methods.filter(e=>e.useMinTotal&&t.minTotal<+e.prices[0].from);e.length?this.arrMinDelivery=e.map(e=>(e.$item=t.$form.find(`[data-delivery="${e.id}"]`),e)):this.arrMinDelivery=[]},onUpdate(){this.onInit(),this.isOpen&&(this.$container.addClass("fade-in noanimate"),this.open())},onLoad(){this.events(),this.formInit(),this.renderButton(),this.isOpen&&this.renderList()},onUpdateList(){this.updatePrices(),this.isOpen&&this.renderList()},onItemsAdd(){this.$button.removeClass("blink"),this.$button.outerWidth(),this.$button.addClass("blink"),this.updatePrices(),this.isOpen&&this.renderList(),this.isAutoOpen&&1===this.count&&setTimeout(()=>{this.open()},200)},onItemsRemove(){this.updatePrices(),this.list.length||flexbe_cli.widget.cart.dispatch("resetChangedList"),this.isOpen&&this.renderList()},onResetList(){this.updatePrices()},onUpdateCount(){this.updatePrices()},onDeliveryChange(){this.updatePrices()},formInit(){let t=flexbe_cli.components.instances[this.id];t=t.filter(t=>"form"===t.is),t.forEach(t=>{this.form=t,t.defineBeforeSend(async()=>{const e=[...this.list],i=flexbe_cli.widget.cart.delivery.getActive(),s=this.hasDelivery&&i.price.untilMinTotal;return!(this.minTotal&&this.minTotal>this.total||s)&&(this.hasDelivery&&i&&e.push({id:`delivery:${i.id}`,type:"delivery",title:i.title,img:"",price:i.price.current,count:1}),t.addItems(e),!flexbe_cli.is_admin&&(await this.loadProductsList(),this.changedList.length)?this.getChangedPricesConfirmation():void 0)}),t.defineAfterSent(()=>{flexbe_cli.is_admin||this.close(),flexbe_cli.stat.ecommerce.purchase(this.list),flexbe_cli.widget.cart.dispatch("resetList")})})},events(){let t,e;const i=()=>{if(flexbe_cli.is_admin){if((window.parent.flexbe.modal.visible||[]).length)return!1}return!0};flexbe_cli.events.off("ui_cart_open.cart-widget").on("ui_cart_open.cart-widget",()=>{this.open()}),flexbe_cli.events.off("ui_cart_close.cart-widget").on("ui_cart_close.cart-widget",()=>{this.close()}),flexbe_cli.widget.cart.off("dispatch.cart-widget").on("dispatch.cart-widget",(t,{name:e})=>{switch(e){case"updateList":this.onUpdateList();break;case"updateCount":this.onUpdateCount();break;case"addItem":this.onItemsAdd();break;case"removeItem":this.onItemsRemove();break;case"resetList":this.onResetList();break;case"updateChangedList":case"removeChangedItem":case"resetChangedList":this.managePriceChangedBlock()}}),flexbe_cli.widget.cart.delivery.off("dispatch.cart-widget").on("dispatch.cart-widget",(t,{name:e})=>{"selectMethod"===e&&this.onDeliveryChange()}),this.$widget.off("click.cart-button").on("click.cart-button",".cart-button",()=>{this.isOpen?this.close():this.open()}),this.$container.off("click.close-button").on("click.close-button","a.close",t=>{t.target===t.currentTarget&&this.close()}),this.$container.off(".close-overlay").on("mouseup.close-overlay mousedown.close-overlay",'[data-overlay="true"]',s=>{if(i())return"mousedown"===s.type?(t=s.target,void(e=s.target.clientWidth<=s.pageX)):void(s.target!==t||s.target!==s.currentTarget||e||(t=null,this.close()))}),$(document).off("keyup.cart_esc_close").on("keyup.cart_esc_close",t=>{27===t.which&&i()&&!flexbe_cli.modal.$list.hasClass("rise")&&this.close()}),this.$list.off("click").on("click","[data-action]",t=>{const e=$(t.currentTarget),i=e.closest("li"),s=i.attr("data-variant-id"),a=i.attr("data-id"),o=flexbe_cli.widget.cart.getItem(a,s),n=e.attr("data-action"),l=e.hasClass("disabled");a&&o&&!l&&("remove"===n||"-"===n&&1===o.count?(flexbe_cli.widget.cart.dispatch("removeItem",a,s),o.variantId&&flexbe_cli.widget.cart.dispatch("removeChangedItem",o.variantId)):(flexbe_cli.widget.cart.dispatch("updateCount",{id:a,variantId:s,count:n}),this.updateItemNode(i)))}),this.$list.off("input blur").on("input blur","input.count",t=>{const e=$(t.currentTarget),i=e.closest("li").attr("data-variant-id"),s=e.closest("li").attr("data-id"),a=+t.currentTarget.value||0,o="blur"===t.type||"focusout"===t.type;a||o&&""===t.currentTarget.value?(flexbe_cli.widget.cart.dispatch("updateCount",{id:s,variantId:i,count:a}),this.updateItemNode(e.closest("li"))):o&&flexbe_cli.widget.cart.dispatch("removeItem",s,i)})},open(){this.isOpen=!0,flexbe_cli.block.pushOverlay("cart",!0),flexbe_cli.is_admin?this.$container.addClass("is-editor"):(this.$button.addClass("hide"),this.loadProductsList(),this.setLoadInterval(),/cart/.test(location.hash)||(/^#{1,2}/.test(location.hash)&&(this.oldHash=location.hash),flexbe_cli.lockPopstate=!0,history.pushState(null,null,"#cart"),flexbe_cli.lockPopstate=!1)),this.updatePrices(),this.renderList(),flexbe_cli.scroll.scrollLock.lock(),this.$area.addClass("show"),this.$container.hasClass("noanimate")?(this.$container.addClass("show fade-in"),this.$container.removeClass("noanimate")):(this.$container.addClass("show"),this.$container.outerHeight(),this.$container.addClass("fade-in"),this.$container.removeClass("noanimate")),this._onOpen(),flexbe_cli.events.emit("cart_opened")},close(){if($(window).off("keyup.cart_esc_close"),flexbe_cli.block.removeOverlay("cart"),this.isOpen){if(this.isOpen=!1,flexbe_cli.scroll.scrollLock.unlock(),this.$area.removeClass("show"),this.$button.removeClass("hide"),this.$container.removeClass("fade-in"),this.$container.addClass("fade-out"),this.destroyTooltips(),/cart/.test(location.hash)){const t=this.oldHash&&this.oldHash!==location.hash?this.oldHash:"#";flexbe_cli.lockPopstate=!0,history.replaceState(null,null,t),flexbe_cli.lockPopstate=!1,this.oldHash=null}setTimeout(()=>{this.$container.removeClass("fade-out show noanimate")},350),this._onClose(),flexbe_cli.events.emit("cart_closed"),flexbe_cli.is_admin||clearInterval(this.loadInterval)}},loadProductsList(){this.list.length&&$.ajax({url:"/ecommerce_api/products",type:"GET",dataType:"json",data:{}}).done(t=>{if(t&&t.length){const e=t.map(t=>_extends({},t,{price:t.price||0})),i=this.list.map(t=>{const i=e.find(e=>e.productId===t.productId&&e.variantId===t.variantId);return i?_extends({},t,i,{price:i.price||0}):t});flexbe_cli.widget.cart.dispatch("updateChangedList",this.getChangedList(e)),flexbe_cli.widget.cart.dispatch("updateList",i)}})},setLoadInterval(){clearInterval(this.loadInterval),this.loadInterval=setInterval(()=>{this.loadProductsList()},36e5)},renderList(){this.listRendered=!0,this.list.length?this.$container.removeClass("cart-is-empty"):this.$container.addClass("cart-is-empty"),this.$list.html(n(this.list,{showInStockStatuses:this.showInStockStatuses,showVendorCode:this.showVendorCode})),this.initTooltips()},renderButton(){this.$buttonCount.text(this.count),this.$button.toggleClass("hidden",0===this.count||$(".header-cart-button-holder").length>0)},updatePrices(){const t=this,e=this.count,i=this.total,s=this.hasDelivery,a=flexbe_cli.widget.cart.delivery.getPrice(),o=a.freeFrom?a.useNotFixTotal&&a.untilFree:a.useNotFixTotal,n=o?"⏤":a.currentFormatted,l=this.minTotal-this.total,c=this.minTotal>a.minTotal&&l>0;this.renderButton(),this.updateProductsList(),this.minTotal&&this.$minTotal.length&&(this.$minTotal.toggleClass("show",c),this.$minTotal.find(".min-total__total").text(flexbe_cli.locale.formatMoney(this.minTotal,{freeLabel:!0})),flexbe_cli.locale.animateNumber({target:this.$minTotal.find(".min-total__count"),to:l,asMoney:!0,freeLabel:!1})),this.arrMinDelivery.length&&this.arrMinDelivery.forEach(e=>{const i=e.prices[0].from>t.total;e.$item.toggleClass("form-field-delivery-item--blocked",i)}),this.$shipping.text(n),this.$subtotal.text(flexbe_cli.locale.formatMoney(i,{freeLabel:!0})),this.$shippingNotFix.toggleClass("show",!!o);const r=s&&!o?i+a.current:i;flexbe_cli.locale.animateNumber({target:this.$total,to:r,asMoney:!0}),this.$count.text(e),this.$container.find(".product-count .count").text(e),this.$delivery.toggleClass("hide",!s),this.toggleFormButtonDisabled(),this.toggleUntilFreeLoader()},updateProductsList(){this.listRendered&&this.list.forEach(t=>{const e=t.variantId?this.$list.find(`[data-variant-id="${t.variantId}"]`):this.$list.find(`[data-id="${t.id}"]`),i=e.find(".cart-price");e.find(".count").val(t.count),e.find(".cart-sum").text(flexbe_cli.locale.formatMoney(t.price*t.count)),i.toggleClass("hidden",4!==flexbe_cli.theme_id||1===t.count),i.find("span").text(flexbe_cli.locale.formatMoney(t.price))})},toggleFormButtonDisabled(){const t=this.$formButton,e=flexbe_cli.widget.cart.delivery.getPrice(),i=this.minTotal-this.total,s=this.minTotal>e.minTotal,a=s&&i>0,o=!this.allowPreorder&&this.list.find(t=>{const e=+t.count,i=+t.quantity;return!(null==t.quantity||"number"!=typeof t.quantity)&&(this.considerQuantity?e>i:0===i&&e>0)}),n=a||e.untilMinTotal||o;t.toggleClass("disabled",!!n);const l=t.hasClass("disabled");if(l){const i=`${flexbe_cli.locale.tr("cart.min_total_tip")} ${flexbe_cli.locale.formatMoney(this.minTotal,{freeLabel:!0})}`,n=`${flexbe_cli.locale.tr("cart.min_total_delivery_tip")} ${e.minTotalFormatted}`;let l=!1;o?l=`${flexbe_cli.locale.tr("cart.some_items_not_available_tip")}`:a?l=i:s&&(l=n),t.attr("data-tip",l||"")}else t.attr("data-tip","");l?t.off("click.disabled").on("click.disabled",()=>{setTimeout(()=>{t.addClass("shake"),setTimeout(()=>{t.removeClass("shake")},500)},30)}):t.off("click.disabled")},toggleUntilFreeLoader(){const t=flexbe_cli.widget.cart.delivery.getPrice(),e=this.minTotal-this.total,i=this.minTotal>t.minTotal;if(this.hasDelivery&&this.$untilFree.length){const s=t.untilMinTotal/t.minTotal*100,a=t.untilFree/t.freeFrom*100,o=t.untilMinTotal?s:a,n=(t.untilFree||t.untilMinTotal)&&(!(e>0)||!i);this.$untilFree.toggleClass("show",!!n),this.$untilFree.toggleClass("show-min-total",!!t.untilMinTotal),this.$untilFree.find(".progress-path").attr("stroke-dashoffset",o),flexbe_cli.locale.animateNumber({target:this.$untilFree.find(".delivery-free__count"),to:t.untilFree,asMoney:!0,freeLabel:!1}),flexbe_cli.locale.animateNumber({target:this.$untilFree.find(".delivery-min-total__count"),to:t.untilMinTotal,asMoney:!0,freeLabel:!1})}},updateItemNode(t){const e=t.attr("data-variant-id"),i=t.attr("data-id"),s=flexbe_cli.widget.cart.getItem(i,e),a=t.find('[data-action="+"]'),n=t.find(".item-status"),l=t.find(".count"),c=o.getStatus(s),r=("in_stock"===c.key||"items_in_stock"===c.key)&&!this.showInStockStatuses,d=+s.count,h=+s.quantity,u=null==s.quantity||"number"!=typeof s.quantity;if(a&&a.length){const t=!this.allowPreorder&&!u&&(this.considerQuantity?d>=h:0===h);a.toggleClass("disabled",t),a.attr("data-tip",o.getTooltip(s)),this.updateTooltips()}if(n&&n.length&&(n.removeClass(),n.addClass(`item-status ${c.class?c.class:""}`),n.toggleClass("hidden",!c.key||r),n[0].innerText=c.title?c.title:""),l&&l.length){const t=!this.allowPreorder&&!u&&(this.considerQuantity?d>h:0===h);l.toggleClass("error",t)}},renderNotificationModal(t){const e=l(this.changedList,{showFooter:t});$("body").append(e),this.$productsNotificationsModal=$(".products-notifications")},getChangedPricesConfirmation(t=!0){return new Promise(e=>{this.renderNotificationModal(t),this.$productsNotificationsModal.addClass("show fade-in"),this.$productsNotificationsModal.off("click").on("click",t=>{const i=$(t.target),s=i.closest(".modal").length,a=i.closest(".close").length,o=i.closest('[data-action="cancel"]').length,n=i.closest('[data-action="apply"]').length;a||o||!s?(this.closeNotificationModal(),e(!1)):n&&(this.closeNotificationModal(),clearInterval(this.loadInterval),e(!0))})})},closeNotificationModal(){this.$productsNotificationsModal.removeClass("fade-in").addClass("fade-out"),setTimeout(()=>{this.$productsNotificationsModal.off("click"),this.$productsNotificationsModal.remove()},250)},getChangedList(t){const e=[];return t.forEach(t=>{this.list.forEach(i=>{const s=t.price!==i.price;t.productId===i.productId&&t.variantId===i.variantId&&s&&e.push(_extends({},t,{old_price:i.price}))})}),e},managePriceChangedBlock(){if(!flexbe_cli.is_admin&&this.showChangedPrices){const e=this.$productsChanged.find(".cart-products-changed__text");let i=this.$container.find(".open-products-change-modal");this.changedList.length&&e&&!e[0].innerHTML?(e[0].innerHTML=(t=this.changedList,`${flexbe_cli.locale.tr("cart::price_confirmation::items_price_changed",{count:t.length})}<br/>\n            <div class="open-products-change-modal">${flexbe_cli.locale.tr("cart::price_confirmation::more_button")}</div>`),i=this.$container.find(".open-products-change-modal"),i.off("click").on("click",()=>{this.getChangedPricesConfirmation(!1)})):this.changedList.length||(e&&e.length&&(e[0].innerHTML=""),i&&i.length&&i.off("click")),this.$productsChanged.toggleClass("show",this.changedList.length>0)}var t},initTooltips(){flexbe_cli.tip&&(this.$tooltips=this.$container.find("[data-tip]"),this.$tooltips&&this.$tooltips.length&&this.$tooltips.each((t,e)=>{const i=$(e).attr("data-tip");i&&flexbe_cli.tip.init(e,{content:i})}))},updateTooltips(){flexbe_cli.tip&&this.$tooltips&&this.$tooltips.length&&this.$tooltips.each((t,e)=>{const i=$(e).attr("data-tip");i?flexbe_cli.tip.init(e,{content:i}):flexbe_cli.tip.destroy(e)})},destroyTooltips(){flexbe_cli.tip&&this.$tooltips&&this.$tooltips.length&&this.$tooltips.each((t,e)=>{flexbe_cli.tip.destroy(e)})}})}();
!function(){const e={hidden:"hidden-mobile",navCreated:"mobile-navigation--created",cartContainer:"nav-header-controls--cart",burgerContainer:"nav-header-controls--burger"},t={block:".b_block",element:".element-item",nav:".mobile-navigation",header:".header-wrapper",cartBtn:".widget-list .cart-button",headerCartBtn:".header-cart-button",navbar:".nav-header",navbarContent:".nav-header-content",navbarControls:".nav-header-controls",navmenu:".nav-menu",navmenuItem:".nav-menu-item"},n=(n,a=!1)=>{let i=$(n);if(!i.is(t.element)){const e=i.closest(t.element);i=e.length?e:i}i.toggleClass(e.hidden,!a)};flexbe_cli.widget.register("MENU01",{created:{},onLoad(){this.createWidget()},createWidget(){this.clickEvent="click",this.navbarStyle=!1,this.navmenuCreated=!1;const a=flexbe_cli.block.$list,i=$(t.block),s=a.find(`.${e.hidden}`);n(s,!0);let o=i.not('[data-hidden="mobile"]').slice(0,3).find(t.header);if(o=o.filter((e,t)=>{const n=$(t).offset();return n&&n.top<flexbe_cli.resize.viewportHeight}),o.length){const e=o.eq(0).attr("data-fixed-color")||"light",t=o.eq(0).attr("data-fixed-contrast")||"dark",n=o.eq(0).hasClass("floating-header");this.menuFixed=n,this.cssBackground=e,this.background=e,this.contrast=t,["light","dark"].includes(e)&&(this.cssBackground="light"===e?"#FFF":"#000"),o.length>1&&(o=o.filter((e,n)=>$(n).attr("data-fixed-contrast")===t))}if(this.$source=o,this.$nav=this.$area.find(t.nav),this.$navbar=this.$area.find(t.navbar),this.$navmenu=this.$area.find(t.navmenu),this.fillNavmenu(),this.fillNavbar(),this.navbarStyle){if(this.background||this.cssBackground)if(["light","dark"].includes(this.background))this.$nav.attr("data-color",this.background);else if(this.cssBackground){this.$navbar.css("background-color",this.cssBackground),this.$navmenu.css("background-color",this.cssBackground);const e=$("head"),t=e.find('meta[name="theme-color"]');t.length?t.attr("content",this.cssBackground):e.append(`<meta name="theme-color" content="${this.cssBackground}"/>`)}if(this.created.logo&&flexbe_cli.run.is_android){const e=this.$nav.find(".component-logo-img"),t=e.css("background-image");e.css("background-image","none"),setTimeout(()=>{e.css("background-image",t)},50)}this.contrast?this.$nav.attr("data-contrast",this.contrast):this.color&&this.$nav.css("color",this.color),this.menuFixed&&this.$nav.addClass("menu-fixed"),this.animationMobileShow()}s.closest(".b_block").each((e,t)=>{t._core&&t._core.updateTween()}),this.navmenuCreated&&(flexbe_cli.entity.initArea(this.$nav),flexbe_cli.events.off("ui_mobilemenu_open").on("ui_mobilemenu_open",()=>{this.openMenu()}),flexbe_cli.events.off("ui_mobilemenu_close").on("ui_mobilemenu_close",()=>{this.closeMenu()})),$(window).off("resized.wigetmenu").on("resized.wigetmenu",()=>{this.animationMobileShow()})},animationMobileShow(){flexbe_cli.block.$list;setTimeout(()=>{this.$nav.addClass(`${e.navCreated} header-style-${this.navbarStyle}`),this.$source.find(".elements-list").each((e,t)=>{t.offsetHeight<40&&n(t.closest(".header-area, .b_block"),!1)}),$("body").addClass(`is-mobile-menu--${this.navbarStyle}`)},10)},fillNavbar(){const a=this,{created:i,$navbar:s,$source:o,navmenuCreated:r}=a,c=s.find(t.navbarContent),l=s.find(t.navbarControls);c.empty(),l.empty();const d=[],h=[];!function(){const s=$(t.cartBtn).eq(0),o=$(t.headerCartBtn).eq(0);if(o.length||s.length){i.cart=!0,h.push("cart");const t=s.find("svg"),r=s.find(".cart-button-count"),c=o.find("svg"),d=o.find(".header-cart-button-count");let u,g,b;u=c.length?c.html():t.html(),d.length?(g=d.css("color"),b=d.css("background-color"),"rgba(0, 0, 0, 0)"===b&&(g="rgb(255, 255, 255, 1)",b="rgb(234, 127, 84, 1)")):(g=r.css("color"),b=r.css("background-color"));const m=`\n                        <li class="${e.cartContainer}">\n                            <div class="cart-button hidden">\n                                <svg class="cart-button-icon">\n                                    ${u}\n                                </svg>\n                                <div class="cart-button-count" style="color: ${g}; background: ${b}">0</div>\n                            </div>\n                        </li>`;a.$cart=$(m),l.append(a.$cart),n(s,!1),o.length||a.background||(a.color=s.css("color"),a.cssBackground=s.css("background-color"),a.background=a.cssBackground)}else i.cart=!1;if(i.cart){const e=flexbe_cli.widget.cart,t=a.$area.find(".cart-button"),n=t.find(".cart-button-count");l.toggleClass("cart-empty",!e.getCount()),n.text(e.getCount()),a.$cart.on(a.clickEvent,()=>{a.toggleMenu(!1),flexbe_cli.events.emit("ui_cart_open")}),flexbe_cli.widget.cart.off("dispatch.mobilemenu").on("dispatch.mobilemenu",(a,{name:i})=>{l.toggleClass("cart-empty",!e.getCount()),n.text(e.getCount()),"addItem"===i&&(t.addClass("blink"),setTimeout(()=>{t.removeClass("blink")},300))})}i.cart}(),function(){r?(a.$burger=$(`<li class="${e.burgerContainer}"><i></i><i></i><i></i></li>`),l.append(a.$burger),h.push("burger"),a.$burger.on(a.clickEvent,()=>{a.toggleMenu()}),i.burger=!0):i.burger=!1;i.burger}(),this.$nav.attr("data-enabled",!!h.length),h.length&&function(){const e=o.find(".component-logo").eq(0);if(e.length){const t=40/Math.max(.25,e.innerHeight()/e.innerWidth()),a=e.clone();i.logo=!0,a.css({fontSize:"",maxWidth:`${t}px`}),c.append(a),d.push("logo"),n(e,!1)}else i.logo=!1;i.logo}(),d.length&&h.length||h.length>1?this.navbarStyle="panel":0===d.length&&1===h.length?(this.navbarStyle="round",this.menuFixed=!0):this.navbarStyle=!1},fillNavmenu(){const{created:e,$source:a,$navmenu:i}=this;return i.find(t.navmenuItem).each((t,i)=>{const s=$(i),o=s.attr("data-element"),r=a.find(`[data-e-id="${o}"]`),c=r.length,l=s.hasClass("nav-menu-item--cart"),d=s.hasClass("nav-menu-item--spacer");if(c){if(!l&&!d){const e=r.clone();e.attr("data-cloned",!0),s.append(e),s.find('[data-direction="row"]').attr("data-direction","column"),s.find(".element-content").removeClass("justify-content-center justify-content-end").addClass("justify-content-start")}n(r,!1),e[o]=e[o]?e[o]+c:c}}),this.navmenuCreated=Object.keys(e).length,this.navmenuCreated},toggleMenu(e){this[(e=void 0===e?!(e=[!0,"true"].includes(this.$nav.attr("data-opened"))):!!e)?"openMenu":"closeMenu"]()},openMenu(){this.isOpen=!0,this.$area.addClass("show"),this.$nav.outerHeight(),this.$nav.attr("data-opened",!0),this.$navmenu.addClass("active"),this.$burger&&this.$burger.addClass("active"),flexbe_cli.scroll.scrollLock.lock(),flexbe_cli.block.pushOverlay("mobilemenu"),this.setAreaSize(),this._onOpen(),$(window).on("resized.mobilemenu",()=>{this.setAreaSize()}),flexbe_cli.run.is_screen_mobile_all&&($("body").addClass("is-widget-open").css("background",this.cssBackground),this.menuFixed||$("body, html").scrollTop(0))},closeMenu(){this.isOpen=!1,flexbe_cli.run.is_screen_mobile_all&&($("body").removeClass("is-widget-open").css("background",""),Array.from(this.$navmenu.find(".folder-item")).forEach(e=>{$(e).removeClass("show"),$(e.lastElementChild).slideUp(0)})),this.$area.removeClass("show"),this.$area.css("height",""),this.$nav.attr("data-opened",!1),this.$navmenu.removeClass("active"),this.$burger&&this.$burger.removeClass("active"),flexbe_cli.scroll.scrollLock.unlock(),flexbe_cli.block.removeOverlay("mobilemenu"),$(window).off("resized.mobilemenu"),this._onClose()},setAreaSize(){const e=this.isOpen?`${flexbe_cli.resize.viewportHeight}px`:"";this.$area.css("height",e)}})}();